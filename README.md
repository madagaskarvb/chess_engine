https://docs.google.com/document/d/1YMsD4ncYxSyghjWPykyCXnIuo7gXpn5yDRoLwnr9fQQ/edit?usp=sharing

![image](https://github.com/user-attachments/assets/2852e1b2-019d-4c55-9791-b5d8eb19a596)

# Chess With AI Opponent

**Общая цель:**  
Создать интерактивную игру в шахматы с графическим интерфейсом, где пользователь играет против искусственного интеллекта. Игра должна обеспечивать удобное управление фигурами, визуализацию шахматной доски и реалистичное поведение ИИ, способного принимать разумные шахматные решения.

**Функциональные возможности системы:**

1. **Графический интерфейс:**  
- Отображение шахматной доски с чередующимися светлыми и тёмными клетками.
- Визуализация фигур с возможностью их перетаскивания и выбора ходов с помощью мыши.
- Отображение координат доски (буквы и цифры) для удобства ориентации.
    
2. **Игровой процесс:**  
- Реализация правил классических шахмат с корректной обработкой ходов, рокировок и тд.
- Поддержка поочерёдного хода белых и чёрных фигур.
- Проверка и обработка шаха, мата и патовых ситуаций, а также окончание игры при достижении этих условий.
    
3. **Искусственный интеллект (ИИ):**  
- Управление ходами чёрных фигур ИИ, основанное на алгоритме альфа-бета с поиском с ограниченной глубиной.
- Применение поиска с квиеcценцией для более точной оценки тактических позиций и избежания эффекта горизонта.


## Описание зависимостей

1. **Python 3.9+**
Основной язык разработки. Версия 3.9 или выше обеспечивает поддержку всех необходимых функций и библиотек.
    
2. - **PyQt6**
Набор Python-привязок к фреймворку Qt 6, обеспечивающий инструменты для создания графических пользовательских интерфейсов (GUI). Позволяет создавать кроссплатформенные настольные   приложения с богатым функционалом.

3. - **Qt 6**
Кроссплатформенный фреймворк для разработки GUI и приложений с расширенными возможностями, такими как работа с графикой, мультимедиа, сетью и базами данных. PyQt6 является обёрткой над Qt 6.


## Поддержка ОС

PyQt6 поддерживается на основных платформах: 
- Windows (10 и выше),
- macOS (12 и выше), 
- Linux и других UNIX-подобных системах.


## Описание структуры кода (классы и функции)
###  Модуль GUI - Вывод графического интерфейса

<img width="799" alt="Screenshot 2025-06-26 at 05 29 57" src="https://github.com/user-attachments/assets/64b5b3a5-dec4-47b2-b4b5-d5fb734e6e86" />

#### **AIThread**
Назначение: Поток для выполнения расчетов ИИ в фоновом режиме.

Описание:
- Наследуется от QThread для работы в отдельном потоке
- Генерирует сигнал move_ready при готовности хода
- Выполняет расчет лучшего хода ИИ без блокировки интерфейса.

Ключевые элементы:
- `move_ready`: Сигнал с координатами хода (from_col, from_row, to_col, to_row)
- `run()`: Основной метод, где вызывается ИИ для расчета хода

---

#### **Game**  
Назначение: Управление игровым состоянием и логикой ходов.

Описание:
- Следит за текущим игроком, состоянием игры и сменой ходов  
- Проверяет шах/мат/ничью  
- Синхронизирует состояние с заголовком окна

Ключевые методы: 
- `switch_turn()`: Переключает активного игрока  
- `update_window_title()`: Обновляет заголовок окна с учетом шаха  
- `reset()`: Сбрасывает состояние игры

---

#### **PromotionDialog**  
Назначение: Диалоговое окно для выбора фигуры при превращении пешки.

Описание:
- Отображается при достижении пешкой последней горизонтали  
- Предоставляет выбор из 4 фигур (ферзь, ладья, слон, конь)

Ключевые элементы:
- `set_selected_type()`: Запоминает выбор игрока  
- `get_selected_type()`: Возвращает выбранный тип фигуры

---

#### **GameOverDialog**  
Назначение: Диалоговое окно окончания игры.

Описание: 
- Отображает победителя/ничью  
- Предлагает начать новую игру или выйти

Ключевые элементы:
- Кнопки "New Game" (перезапуск) и "Quit" (выход)

---

#### **ChessPiece**  
Назначение: Графическое представление шахматной фигуры.

Описание:
- Обрабатывает перетаскивание и взаимодействие с фигурой  
- Проверяет валидность ходов  
- Автоматически определяет специальные правила (рокировка, превращение)

Ключевые методы:
- `mouseReleaseEvent()`: Основная логика обработки хода  
  - Обрабатывает: перемещение, захват фигур, рокировку, превращение пешки

---

#### **ChessBoard**  
Назначение: Основной виджет игрового поля.

Описание: 
- Создает графическую сцену с клетками и фигурами  
- Координирует взаимодействие между GUI и логикой игры  
- Управляет ИИ-соперником

Ключевые методы:
- `draw_board()`: Рисует шахматную доску  
- `setup_pieces()`: Расставляет фигуры  
- `trigger_ai_move()`: Инициирует ход ИИ  
- `handle_promotion()`: Обрабатывает превращение пешки  
- `handle_game_over()`: Управляет окончанием игры  
- `reset_game()`: Полный сброс игры

---

#### **ChessWindow**  
Назначение: Главное окно приложения.

Описание:  
- Создает и настраивает основной интерфейс  
- Содержит экземпляр ChessBoard как центральный виджет  
- Управляет размерами окна и заголовком


### Модуль logic.py - Шахматная логика

<img width="167" alt="Screenshot 2025-06-26 at 06 03 33" src="https://github.com/user-attachments/assets/d832d9b5-2154-4a83-a972-60e2c4a0ab35" />

#### **Color (Enum)**  
Назначение: Представление цвета шахматных фигур.  

Описание: 
- Определяет два возможных цвета: `WHITE` (белые) и `BLACK` (черные)  
- Используется для идентификации принадлежности фигур и определения правил хода  

---

#### **Type (Enum)**  
Назначение: Классификация типов шахматных фигур.  

Описание: 
- Содержит 6 вариантов:  
  `KING` (король), `QUEEN` (ферзь), `ROOK` (ладья),  
  `BISHOP` (слон), `KNIGHT` (конь), `PAWN` (пешка)  
- Определяет поведение и возможности каждой фигуры  

---

#### **Piece (Abstract Base Class)**  
Назначение: Базовый класс для всех шахматных фигур.  

Атрибуты:  
- `name`: Тип фигуры (`Type`)  
- `x`, `y`: Позиция на доске  
- `color`: Цвет фигуры (`Color`)  

Абстрактные методы:  
- `is_valid_move()`: Проверка допустимости обычного хода  
- `is_valid_capture()`: Проверка допустимости захвата  

Общие методы:  
- `move()`: Обновление позиции фигуры  
- `get_valid_moves()`: Получение всех допустимых ходов  

---

#### **King (Король)**  
Назначение: Реализация логики короля.  

Особенности:  
- Перемещается на 1 клетку в любом направлении  
- Реализует правила рокировки  
- Следит за статусом `hasMovedBefore` (первый ход)  
- Проверяет отсутствие шаха после хода  

---

#### **Queen (Ферзь)**  
Назначение: Реализация логики ферзя.  

Особенности:  
- Комбинирует возможности ладьи и слона  
- Перемещается на любое расстояние по вертикали/горизонтали/диагонали  
- Не перепрыгивает через фигуры  

---

#### **Rook (Ладья)**  
Назначение: Реализация логики ладьи.  

Особенности:  
- Перемещается по вертикали/горизонтали на любое расстояние  
- Следит за статусом `hasMovedBefore` для рокировки  
- Не перепрыгивает через фигуры  

---

#### **Bishop (Слон)**  
Назначение: Реализация логики слона.  

Особенности:  
- Перемещается по диагонали на любое расстояние  
- Всегда остается на клетках одного цвета  
- Не перепрыгивает через фигуры  

---

#### **Knight (Конь)**  
Назначение: Реализация логики коня.  

Особенности:  
- Ходит буквой "Г" (2+1 клетки)  
- Может перепрыгивать через фигуры  
- Простейшая логика перемещения  

---

#### **Pawn (Пешка)**  
Назначение: Реализация логики пешки.  

Особенности:  
- Разные правила для хода и взятия  
- Первый ход: на 2 клетки вперед  
- Бьет только по диагонали  
- Превращение обрабатывается на уровне GUI  

---

#### **ChessBoard (Шахматная доска)**  
Назначение: Управление игровым состоянием и логикой.  

Ключевые функции:  
- Инициализация стартовой позиции (`initialize_pieces()`)  
- Визуализация доски (`__str__()`)  
- Управление перемещением (`move_piece()`)  

Проверка состояний:  
- Шах (`is_in_check()`)  
- Мат (`is_checkmate()`)  
- Пат (`is_stalemate()`)  
- Ничья (`is_draw()`, `is_insufficient_material()`)  

Важные методы:  
- `get_piece_at()`: Получение фигуры по координатам  
- `move_resolves_check()`: Симуляция ходов  
- `move_piece()`: Основной метод хода с проверкой правил  


### Модуль ИИ - Алгоритм альфа-бета с поиском с ограниченной глубиной.

#### **ChessAI**  
Назначение: Класс, реализующий логику искусственного интеллекта для игры в шахматы. Отвечает за выбор оптимальных ходов для чёрных фигур с использованием оценки позиции и поиска с огранчением глубины.

Ключевые методы:
- `get_piece_value(piece)`: Возвращает численное значение фигуры для оценки.  
- `static_eval(board)`: Выполняет статическую оценку позиции на доске.  
- `get_all_possible_moves(board, color)`: Возвращает список всех легальных ходов для заданного цвета, не оставляющих короля под шахом.  
- `is_favorable_move(board, from_col, from_row, to_col, to_row)`: Определяет, является ли ход выгодным с точки зрения ИИ.  
- `quiescence_search(board, depth, is_max_player, alpha, beta)`: Выполняет углублённый поиск с квиеcценцией для оценки тактических позиций.  
- `copy_board(board)`: Создаёт глубокую копию объекта доски с текущим расположением фигур.  
- `get_best_move(board)`: Находит и возвращает лучший ход для чёрных фигур согласно текущей позиции и стратегии ИИ.
